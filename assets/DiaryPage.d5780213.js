import{Q as Ie}from"./QDrawer.b8b23714.js";import{m as at,l as lt,c as it,Q as rt}from"./QSelect.34837192.js";import{Q as st}from"./QPage.6be4bf92.js";import{Q as ut,a as ct}from"./QLayout.722edce1.js";import{_ as dt}from"./DiaryNavigationCard.4ae51fff.js";import{x as Ae,i as mt,aA as ve,aZ as ze,c as C,az as ft,h as V,Q as ue,D as _e,aC as vt,g as ce,d as te,A as z,k as T,l as E,m as w,B as de,f as S,v as Ke,z as j,Y as J,aw as pt,ah as pe,C as yt,aG as ht,K as le,W as Me,J as ye,M as ie,r as k,aT as gt,aU as _t,p as B,t as oe,a1 as x,n as U,F as se,a7 as Le,_ as bt,aI as wt,aJ as St,am as xt,al as Tt,o as me,a_ as Dt,a$ as kt,b0 as Ct,b1 as qt,U as be,a as At,b as Lt,b2 as Et,b3 as $t,b4 as It,w as W,aW as we,u as ee,a8 as Mt,a9 as Vt}from"./index.7d689aa6.js";import{u as Pt,a as Ht}from"./use-dark.cf2023cb.js";import{C as Ot}from"./ClosePopup.3a2a7195.js";import{Q as Ye,a as Ge,b as Xe}from"./QItem.7fbffb93.js";import{Q as Rt}from"./QCardSection.e42fc810.js";import{T as Ve}from"./TouchSwipe.1489546a.js";import{Q as Se}from"./QBadge.f8fa88f2.js";import{Q as xe}from"./QItemLabel.95564c13.js";import{c as he}from"./selection.fdd062ff.js";import{u as Qt}from"./home-store.f3789061.js";import{e as ne}from"./rtl.0b4379f4.js";import{D as M}from"./notification.utils.d07b912b.js";import{u as Ut,a as Bt,b as Ft}from"./private.use-form.878fafbf.js";import{b as Wt}from"./format.054b8074.js";import{Q as Pe}from"./QSpinnerIos.38e4eb41.js";import{i as H}from"./isDesktop.a0f4eea6.js";import{u as Nt}from"./app-store.ac9f3c37.js";import"./TouchPan.fb463841.js";import"./QResizeObserver.91ee10d4.js";import"./QChip.b3767b1e.js";import"./QCardActions.b81893af.js";import"./QSeparator.45472c01.js";import"./icons.22af156c.js";import"./entry.api.service.1f4a2865.js";import"./axios.cca5ce9b.js";import"./use-render-cache.3aae9b27.js";var G=Ae({name:"QTimelineEntry",props:{heading:Boolean,tag:{type:String,default:"h3"},side:{type:String,default:"right",validator:e=>["left","right"].includes(e)},icon:String,avatar:String,color:String,title:String,subtitle:String,body:String},setup(e,{slots:t}){const o=mt(ze,ve);if(o===ve)return console.error("QTimelineEntry needs to be child of QTimeline"),ve;const n=C(()=>`q-timeline__entry q-timeline__entry--${e.side}`+(e.icon!==void 0||e.avatar!==void 0?" q-timeline__entry--icon":"")),r=C(()=>`q-timeline__dot text-${e.color||o.color}`),l=C(()=>o.layout==="comfortable"&&o.side==="left");return()=>{const i=ft(t.default,[]);if(e.body!==void 0&&i.unshift(e.body),e.heading===!0){const s=[V("div"),V("div"),V(e.tag,{class:"q-timeline__heading-title"},i)];return V("div",{class:"q-timeline__heading"},l.value===!0?s.reverse():s)}let a;e.icon!==void 0?a=[V(ue,{class:"row items-center justify-center",name:e.icon})]:e.avatar!==void 0&&(a=[V("img",{class:"q-timeline__dot-img",src:e.avatar})]);const c=[V("div",{class:"q-timeline__subtitle"},[V("span",{},_e(t.subtitle,[e.subtitle]))]),V("div",{class:r.value},a),V("div",{class:"q-timeline__content"},[V("h6",{class:"q-timeline__title"},_e(t.title,[e.title]))].concat(i))];return V("li",{class:n.value},l.value===!0?c.reverse():c)}}}),jt=Ae({name:"QTimeline",props:{...Pt,color:{type:String,default:"primary"},side:{type:String,default:"right",validator:e=>["left","right"].includes(e)},layout:{type:String,default:"dense",validator:e=>["dense","comfortable","loose"].includes(e)}},setup(e,{slots:t}){const o=ce(),n=Ht(e,o.proxy.$q);vt(ze,e);const r=C(()=>`q-timeline q-timeline--${e.layout} q-timeline--${e.layout}--${e.side}`+(n.value===!0?" q-timeline--dark":""));return()=>V("ul",{class:r.value},_e(t.default))}});const zt={class:"q-pa-md"},He=te({__name:"DiaryContextCard",setup(e){return(t,o)=>{const n=z("app-card");return T(),E(n,null,{default:w(()=>[de(S(Ke,{dense:"",flat:"",icon:"close",class:"apsolute"},null,512),[[Ot]]),S(at,{class:"fit"},{default:w(()=>[j("div",zt,[S(jt,{color:"secondary"},{default:w(()=>[S(G,{heading:""},{default:w(()=>o[0]||(o[0]=[J(" Timeline heading ")])),_:1}),S(G,{title:"Event Title",subtitle:"February 22, 1986"},{default:w(()=>o[1]||(o[1]=[j("div",null," Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])),_:1}),S(G,{title:"Event Title",subtitle:"February 21, 1986",icon:"delete"},{default:w(()=>o[2]||(o[2]=[j("div",null," Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])),_:1}),S(G,{heading:""},{default:w(()=>o[3]||(o[3]=[J(" November, 2017 ")])),_:1}),S(G,{title:"Event Title",subtitle:"February 22, 1986",avatar:"https://cdn.quasar.dev/img/avatar2.jpg"},{default:w(()=>o[4]||(o[4]=[j("div",null," Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])),_:1}),S(G,{title:"Event Title",subtitle:"February 22, 1986"},{default:w(()=>o[5]||(o[5]=[j("div",null," Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])),_:1}),S(G,{title:"Event Title",subtitle:"February 22, 1986",color:"orange",icon:"done_all"},{default:w(()=>o[6]||(o[6]=[j("div",null," Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])),_:1}),S(G,{title:"Event Title",subtitle:"February 22, 1986"},{default:w(()=>o[7]||(o[7]=[j("div",null," Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])),_:1}),S(G,{title:"Event Title",subtitle:"February 22, 1986"},{default:w(()=>o[8]||(o[8]=[j("div",null," Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])),_:1})]),_:1})])]),_:1})]),_:1})}}});var Kt=pt({name:"touch-hold",beforeMount(e,t){const{modifiers:o}=t;if(o.mouse!==!0&&pe.has.touch!==!0)return;const n={handler:t.value,noop:yt,mouseStart(l){typeof n.handler=="function"&&ht(l)===!0&&(le(n,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),n.start(l,!0))},touchStart(l){if(l.target!==void 0&&typeof n.handler=="function"){const i=l.target;le(n,"temp",[[i,"touchmove","move","passiveCapture"],[i,"touchcancel","end","notPassiveCapture"],[i,"touchend","end","notPassiveCapture"]]),n.start(l)}},start(l,i){n.origin=Me(l);const a=Date.now();pe.is.mobile===!0&&(document.body.classList.add("non-selectable"),he(),n.styleCleanup=c=>{n.styleCleanup=void 0;const s=()=>{document.body.classList.remove("non-selectable")};c===!0?(he(),setTimeout(s,10)):s()}),n.triggered=!1,n.sensitivity=i===!0?n.mouseSensitivity:n.touchSensitivity,n.timer=setTimeout(()=>{n.timer=void 0,he(),n.triggered=!0,n.handler({evt:l,touch:i!==!0,mouse:i===!0,position:n.origin,duration:Date.now()-a})},n.duration)},move(l){const{top:i,left:a}=Me(l);n.timer!==void 0&&(Math.abs(a-n.origin.left)>=n.sensitivity||Math.abs(i-n.origin.top)>=n.sensitivity)&&(clearTimeout(n.timer),n.timer=void 0)},end(l){ye(n,"temp"),n.styleCleanup!==void 0&&n.styleCleanup(n.triggered),n.triggered===!0?l!==void 0&&ie(l):n.timer!==void 0&&(clearTimeout(n.timer),n.timer=void 0)}},r=[600,5,7];if(typeof t.arg=="string"&&t.arg.length!==0&&t.arg.split(":").forEach((l,i)=>{const a=parseInt(l,10);a&&(r[i]=a)}),[n.duration,n.touchSensitivity,n.mouseSensitivity]=r,e.__qtouchhold=n,o.mouse===!0){const l=o.mouseCapture===!0||o.mousecapture===!0?"Capture":"";le(n,"main",[[e,"mousedown","mouseStart",`passive${l}`]])}pe.has.touch===!0&&le(n,"main",[[e,"touchstart","touchStart",`passive${o.capture===!0?"Capture":""}`],[e,"touchend","noop","notPassiveCapture"]])},updated(e,t){const o=e.__qtouchhold;o!==void 0&&t.oldValue!==t.value&&(typeof t.value!="function"&&o.end(),o.handler=t.value)},beforeUnmount(e){const t=e.__qtouchhold;t!==void 0&&(ye(t,"main"),ye(t,"temp"),t.timer!==void 0&&clearTimeout(t.timer),t.styleCleanup!==void 0&&t.styleCleanup(),delete e.__qtouchhold)}});const Yt={key:2},Gt=["innerHTML"],Xt=te({__name:"EntryItem",props:{entry:{type:Object,required:!0},simply:{type:Boolean,required:!1,dafault:!1}},setup(e){const t=k(!1),o=()=>{t.value=!t.value},n=gt(),r=_t();Qt();const l=ne(),i=e;C(()=>M.toPlanetaryDay(M.timestampToDate(i.day.startDateTime))),C(()=>M.timestampToDay(i.day.startDateTime));const a=k(!1),c=()=>{a.value=!1,l.deleteEntry(i.entry.id)};return(s,u)=>{const d=z("app-tag"),y=z("menu-item"),m=z("mobile-menu"),p=z("AppDialogConfirm");return T(),B(se,null,[de((T(),E(Ge,{clickable:"",class:"rounded-borders",onClick:u[0]||(u[0]=()=>{})},{default:w(()=>[S(Ye,null,{default:w(()=>[S(xe,{caption:""},{default:w(()=>[J(oe(x(M).timestampToTime(i.entry.timestamp))+" ",1),i.entry.type==="NOTE_ON_VERSE"&&!i.simply?(T(),E(Se,{key:0,color:"orange"},{default:w(()=>u[5]||(u[5]=[J("Comment on text")])),_:1})):U("",!0),i.entry.type==="NOTE_ON_NUMBER"&&!i.simply?(T(),E(Se,{key:1,color:"purple"},{default:w(()=>[J("Comment on number "+oe(e.entry.reference),1)]),_:1})):U("",!0),i.entry.tags&&!i.simply?(T(),B("span",Yt,[(T(!0),B(se,null,Le(i.entry.tags,b=>(T(),E(d,{key:b.id,tag:b,smallest:""},null,8,["tag"]))),128))])):U("",!0)]),_:1}),S(xe,null,{default:w(()=>[j("p",{innerHTML:i.entry.text},null,8,Gt)]),_:1})]),_:1})]),_:1})),[[bt],[Kt,o,void 0,{mouse:!0}]]),S(m,{bottom:"",modelValue:t.value,"onUpdate:modelValue":u[3]||(u[3]=b=>t.value=b)},{default:w(()=>[S(Xe,{class:"border-radius",separator:""},{default:w(()=>[S(y,{icon:"eva-link-outline",text:"Link to Operation",onClick:u[1]||(u[1]=b=>x(n).push(`/diary/entry-${x(r).params.exerciseId}/link`))}),S(y,{"no-arrow":"",icon:"eva-trash-2-outline",text:"Delete Entry",onClick:u[2]||(u[2]=b=>a.value=!0),class:"text-negative"})]),_:1})]),_:1},8,["modelValue"]),S(p,{model:a.value,title:"Confirm Deleting Entry",description:"This action can not be undone",onCancel:u[4]||(u[4]=b=>a.value=!1),onConfirm:c},null,8,["model"])],64)}}});var Jt=Ae({name:"QRating",props:{...wt,...Ut,modelValue:{type:Number,required:!0},max:{type:[String,Number],default:5},icon:[String,Array],iconHalf:[String,Array],iconSelected:[String,Array],iconAriaLabel:[String,Array],color:[String,Array],colorHalf:[String,Array],colorSelected:[String,Array],noReset:Boolean,noDimming:Boolean,readonly:Boolean,disable:Boolean},emits:["update:modelValue"],setup(e,{slots:t,emit:o}){const{proxy:{$q:n}}=ce(),r=St(e),l=Bt(e),i=Ft(l),a=k(0);let c={};const s=C(()=>e.readonly!==!0&&e.disable!==!0),u=C(()=>`q-rating row inline items-center q-rating--${s.value===!0?"":"non-"}editable`+(e.noDimming===!0?" q-rating--no-dimming":"")+(e.disable===!0?" disabled":"")+(e.color!==void 0&&Array.isArray(e.color)===!1?` text-${e.color}`:"")),d=C(()=>{const h=Array.isArray(e.icon)===!0?e.icon.length:0,f=Array.isArray(e.iconSelected)===!0?e.iconSelected.length:0,q=Array.isArray(e.iconHalf)===!0?e.iconHalf.length:0,I=Array.isArray(e.color)===!0?e.color.length:0,_=Array.isArray(e.colorSelected)===!0?e.colorSelected.length:0,v=Array.isArray(e.colorHalf)===!0?e.colorHalf.length:0;return{iconLen:h,icon:h>0?e.icon[h-1]:e.icon,selIconLen:f,selIcon:f>0?e.iconSelected[f-1]:e.iconSelected,halfIconLen:q,halfIcon:q>0?e.iconHalf[f-1]:e.iconHalf,colorLen:I,color:I>0?e.color[I-1]:e.color,selColorLen:_,selColor:_>0?e.colorSelected[_-1]:e.colorSelected,halfColorLen:v,halfColor:v>0?e.colorHalf[v-1]:e.colorHalf}}),y=C(()=>{if(typeof e.iconAriaLabel=="string"){const h=e.iconAriaLabel.length!==0?`${e.iconAriaLabel} `:"";return f=>`${h}${f}`}if(Array.isArray(e.iconAriaLabel)===!0){const h=e.iconAriaLabel.length;if(h>0)return f=>e.iconAriaLabel[Math.min(f,h)-1]}return(h,f)=>`${f} ${h}`}),m=C(()=>{const h=[],f=d.value,q=Math.ceil(e.modelValue),I=s.value===!0?0:null,_=e.iconHalf===void 0||q===e.modelValue?-1:q;for(let v=1;v<=e.max;v++){const A=a.value===0&&e.modelValue>=v||a.value>0&&a.value>=v,R=_===v&&a.value<v,Y=a.value>0&&(R===!0?q:e.modelValue)>=v&&a.value<v,N=R===!0?v<=f.halfColorLen?e.colorHalf[v-1]:f.halfColor:f.selColor!==void 0&&A===!0?v<=f.selColorLen?e.colorSelected[v-1]:f.selColor:v<=f.colorLen?e.color[v-1]:f.color,Q=(R===!0?v<=f.halfIconLen?e.iconHalf[v-1]:f.halfIcon:f.selIcon!==void 0&&(A===!0||Y===!0)?v<=f.selIconLen?e.iconSelected[v-1]:f.selIcon:v<=f.iconLen?e.icon[v-1]:f.icon)||n.iconSet.rating.icon;h.push({name:(R===!0?v<=f.halfIconLen?e.iconHalf[v-1]:f.halfIcon:f.selIcon!==void 0&&(A===!0||Y===!0)?v<=f.selIconLen?e.iconSelected[v-1]:f.selIcon:v<=f.iconLen?e.icon[v-1]:f.icon)||n.iconSet.rating.icon,attrs:{tabindex:I,role:"radio","aria-checked":e.modelValue===v?"true":"false","aria-label":y.value(v,Q)},iconClass:"q-rating__icon"+(A===!0||R===!0?" q-rating__icon--active":"")+(Y===!0?" q-rating__icon--exselected":"")+(a.value===v?" q-rating__icon--hovered":"")+(N!==void 0?` text-${N}`:"")})}return h}),p=C(()=>{const h={role:"radiogroup"};return e.disable===!0&&(h["aria-disabled"]="true"),e.readonly===!0&&(h["aria-readonly"]="true"),h});function b(h){if(s.value===!0){const f=Wt(parseInt(h,10),1,parseInt(e.max,10)),q=e.noReset!==!0&&e.modelValue===f?0:f;q!==e.modelValue&&o("update:modelValue",q),a.value=0}}function D(h){s.value===!0&&(a.value=h)}function g(h,f){switch(h.keyCode){case 13:case 32:return b(f),ie(h);case 37:case 40:return c[`rt${f-1}`]&&c[`rt${f-1}`].focus(),ie(h);case 39:case 38:return c[`rt${f+1}`]&&c[`rt${f+1}`].focus(),ie(h)}}function L(){a.value=0}return xt(()=>{c={}}),()=>{const h=[];return m.value.forEach(({iconClass:f,name:q,attrs:I},_)=>{const v=_+1;h.push(V("div",{key:v,ref:A=>{c[`rt${v}`]=A},class:"q-rating__icon-container flex flex-center",...I,onClick(){b(v)},onMouseover(){D(v)},onMouseout:L,onFocus(){D(v)},onBlur:L,onKeyup(A){g(A,v)}},Tt(t[`tip-${v}`],[V(ue,{class:f,name:q})])))}),e.name!==void 0&&e.disable!==!0&&i(h,"push"),V("div",{class:u.value,style:r.value,...p.value},h)}}});const Zt={key:0,class:"q-gutter-sm cursor-pointer"},eo={key:1},to=te({__name:"DayTags",setup(e){const t=ne(),o=k([]),n=k(!1),r=()=>{i.value&&(o.value=t.day.tags),n.value=!0},l=()=>{u.value=!0,t.updateDayTags(o.value.map(y=>y.id)).then(()=>{u.value=!1,n.value=!1})},i=C(()=>t.day!=null&&t.day.tags!=null&&t.day.tags.length>0);me(()=>{t.retrieveTags()});const a=k([]);async function c(y,m){y===""&&m(()=>{a.value=t.tags.value}),m(()=>{const p=y.toLowerCase();a.value=t.tags.filter(b=>b.label.toLowerCase().includes(p))})}const s=k(!1),u=k(!1);function d(y,m){s.value=!0,t.createTag(y).then(p=>{m(p,"add-unique")}).finally(()=>{s.value=!1})}return(y,m)=>{const p=z("AppTag"),b=z("app-tag");return n.value?(T(),B("div",eo,[S(lt,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=D=>o.value=D),style:{"min-width":"250px"},options:a.value,multiple:"","use-chips":"","use-input":"",onFilter:c,"input-debounce":"0",onNewValue:d,loading:s.value,"hide-dropdown-icon":""},{options:w(D=>[S(Ge,Dt(kt(D.itemPrps)),{default:w(()=>[S(Ye,null,{default:w(()=>[S(xe,null,{default:w(()=>[J(oe(D.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"selected-item":w(D=>[S(b,{removable:"",dense:"",tag:D.opt,tabindex:D.tabindex,onRemove:g=>D.removeAtIndex(D.index)},null,8,["tag","tabindex","onRemove"])]),loading:w(D=>[S(Pe,{color:"primary",size:"1em"})]),after:w(()=>[u.value?(T(),E(Pe,{key:0,color:"primary",size:"1em"})):(T(),E(Ke,{key:1,icon:"eva-checkmark-outline",color:"primary",rounded:"",dense:"",flat:"","no-caps":"",onClick:l}))]),_:1},8,["modelValue","options","loading"])])):(T(),B("div",Zt,[i.value?(T(!0),B(se,{key:0},Le(x(t).day.tags,D=>(T(),E(p,{key:D.id,tag:D,small:""},null,8,["tag"]))),128)):U("",!0),S(ue,{name:"eva-pricetags-outline",color:"primary",onClick:r})]))}}});function fe(e){return Ct()?(qt(e),!0):!1}function $(e){return typeof e=="function"?e():x(e)}const K={mounted:"mounted",updated:"updated",unmounted:"unmounted"},Je=typeof window!="undefined"&&typeof document!="undefined";typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope;const oo=e=>e!=null,no=Object.prototype.toString,ao=e=>no.call(e)==="[object Object]",O=()=>{},Te=lo();function lo(){var e,t;return Je&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window==null?void 0:window.navigator)==null?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function Ze(e,t){function o(...n){return new Promise((r,l)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(r).catch(l)})}return o}function io(e,t={}){let o,n,r=O;const l=a=>{clearTimeout(a),r(),r=O};return a=>{const c=$(e),s=$(t.maxWait);return o&&l(o),c<=0||s!==void 0&&s<=0?(n&&(l(n),n=null),Promise.resolve(a())):new Promise((u,d)=>{r=t.rejectOnCancel?d:u,s&&!n&&(n=setTimeout(()=>{o&&l(o),n=null,u(a())},s)),o=setTimeout(()=>{n&&l(n),n=null,u(a())},c)})}}function ro(...e){let t=0,o,n=!0,r=O,l,i,a,c,s;!Lt(e[0])&&typeof e[0]=="object"?{delay:i,trailing:a=!0,leading:c=!0,rejectOnCancel:s=!1}=e[0]:[i,a=!0,c=!0,s=!1]=e;const u=()=>{o&&(clearTimeout(o),o=void 0,r(),r=O)};return y=>{const m=$(i),p=Date.now()-t,b=()=>l=y();return u(),m<=0?(t=Date.now(),b()):(p>m&&(c||!n)?(t=Date.now(),b()):a&&(l=new Promise((D,g)=>{r=s?g:D,o=setTimeout(()=>{t=Date.now(),n=!0,D(b()),u()},Math.max(0,m-p))})),!c&&!o&&(o=setTimeout(()=>n=!0,m)),n=!1,l)}}function et(e){return e||ce()}function so(...e){if(e.length!==1)return Et(...e);const t=e[0];return typeof t=="function"?$t(It(()=>({get:t,set:O}))):k(t)}function uo(e,t=200,o={}){return Ze(io(t,o),e)}function co(e,t=200,o=!1,n=!0,r=!1){return Ze(ro(t,o,n,r),e)}function tt(e,t=!0,o){et()?me(e,o):t?e():be(e)}function mo(e,t){et(t)&&At(e,t)}const X=Je?window:void 0;function P(e){var t;const o=$(e);return(t=o==null?void 0:o.$el)!=null?t:o}function F(...e){let t,o,n,r;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,n,r]=e,t=X):[t,o,n,r]=e,!t)return O;Array.isArray(o)||(o=[o]),Array.isArray(n)||(n=[n]);const l=[],i=()=>{l.forEach(u=>u()),l.length=0},a=(u,d,y,m)=>(u.addEventListener(d,y,m),()=>u.removeEventListener(d,y,m)),c=W(()=>[P(t),$(r)],([u,d])=>{if(i(),!u)return;const y=ao(d)?{...d}:d;l.push(...o.flatMap(m=>n.map(p=>a(u,m,p,y))))},{immediate:!0,flush:"post"}),s=()=>{c(),i()};return fe(s),s}let Oe=!1;function Re(e,t,o={}){const{window:n=X,ignore:r=[],capture:l=!0,detectIframe:i=!1}=o;if(!n)return O;Te&&!Oe&&(Oe=!0,Array.from(n.document.body.children).forEach(m=>m.addEventListener("click",O)),n.document.documentElement.addEventListener("click",O));let a=!0;const c=m=>$(r).some(p=>{if(typeof p=="string")return Array.from(n.document.querySelectorAll(p)).some(b=>b===m.target||m.composedPath().includes(b));{const b=P(p);return b&&(m.target===b||m.composedPath().includes(b))}}),s=m=>{const p=P(e);if(!(!p||p===m.target||m.composedPath().includes(p))){if(m.detail===0&&(a=!c(m)),!a){a=!0;return}t(m)}};let u=!1;const d=[F(n,"click",m=>{u||(u=!0,setTimeout(()=>{u=!1},0),s(m))},{passive:!0,capture:l}),F(n,"pointerdown",m=>{const p=P(e);a=!c(m)&&!!(p&&!m.composedPath().includes(p))},{passive:!0}),i&&F(n,"blur",m=>{setTimeout(()=>{var p;const b=P(e);((p=n.document.activeElement)==null?void 0:p.tagName)==="IFRAME"&&!(b!=null&&b.contains(n.document.activeElement))&&t(m)},0)})].filter(Boolean);return()=>d.forEach(m=>m())}const fo={[K.mounted](e,t){const o=!t.modifiers.bubble;if(typeof t.value=="function")e.__onClickOutside_stop=Re(e,t.value,{capture:o});else{const[n,r]=t.value;e.__onClickOutside_stop=Re(e,n,Object.assign({capture:o},r))}},[K.unmounted](e){e.__onClickOutside_stop()}};function vo(e){return typeof e=="function"?e:typeof e=="string"?t=>t.key===e:Array.isArray(e)?t=>e.includes(t.key):()=>!0}function Qe(...e){let t,o,n={};e.length===3?(t=e[0],o=e[1],n=e[2]):e.length===2?typeof e[1]=="object"?(t=!0,o=e[0],n=e[1]):(t=e[0],o=e[1]):(t=!0,o=e[0]);const{target:r=X,eventName:l="keydown",passive:i=!1,dedupe:a=!1}=n,c=vo(t);return F(r,l,u=>{u.repeat&&$(a)||c(u)&&o(u)},i)}K.mounted+"";const po=500,yo=10;function Ue(e,t,o){var n,r;const l=C(()=>P(e));let i,a,c,s=!1;function u(){i&&(clearTimeout(i),i=void 0),a=void 0,c=void 0,s=!1}function d(g){var L,h,f;const[q,I,_]=[c,a,s];if(u(),!(o!=null&&o.onMouseUp)||!I||!q||((L=o==null?void 0:o.modifiers)==null?void 0:L.self)&&g.target!==l.value)return;(h=o==null?void 0:o.modifiers)!=null&&h.prevent&&g.preventDefault(),(f=o==null?void 0:o.modifiers)!=null&&f.stop&&g.stopPropagation();const v=g.x-I.x,A=g.y-I.y,R=Math.sqrt(v*v+A*A);o.onMouseUp(g.timeStamp-q,R,_)}function y(g){var L,h,f,q;((L=o==null?void 0:o.modifiers)==null?void 0:L.self)&&g.target!==l.value||(u(),(h=o==null?void 0:o.modifiers)!=null&&h.prevent&&g.preventDefault(),(f=o==null?void 0:o.modifiers)!=null&&f.stop&&g.stopPropagation(),a={x:g.x,y:g.y},c=g.timeStamp,i=setTimeout(()=>{s=!0,t(g)},(q=o==null?void 0:o.delay)!=null?q:po))}function m(g){var L,h,f,q;if(((L=o==null?void 0:o.modifiers)==null?void 0:L.self)&&g.target!==l.value||!a||(o==null?void 0:o.distanceThreshold)===!1)return;(h=o==null?void 0:o.modifiers)!=null&&h.prevent&&g.preventDefault(),(f=o==null?void 0:o.modifiers)!=null&&f.stop&&g.stopPropagation();const I=g.x-a.x,_=g.y-a.y;Math.sqrt(I*I+_*_)>=((q=o==null?void 0:o.distanceThreshold)!=null?q:yo)&&u()}const p={capture:(n=o==null?void 0:o.modifiers)==null?void 0:n.capture,once:(r=o==null?void 0:o.modifiers)==null?void 0:r.once},b=[F(l,"pointerdown",y,p),F(l,"pointermove",m,p),F(l,["pointerup","pointerleave"],d,p)];return()=>b.forEach(g=>g())}K.mounted+"";function ho(){const e=k(!1),t=ce();return t&&me(()=>{e.value=!0},t),e}function ot(e){const t=ho();return C(()=>(t.value,Boolean(e())))}function Be(e,t={}){const{delayEnter:o=0,delayLeave:n=0,window:r=X}=t,l=k(!1);let i;const a=c=>{const s=c?o:n;i&&(clearTimeout(i),i=void 0),s?i=setTimeout(()=>l.value=c,s):l.value=c};return r&&(F(e,"mouseenter",()=>a(!0),{passive:!0}),F(e,"mouseleave",()=>a(!1),{passive:!0})),l}K.mounted+"";function De(e,t,o={}){const{window:n=X,...r}=o;let l;const i=ot(()=>n&&"ResizeObserver"in n),a=()=>{l&&(l.disconnect(),l=void 0)},c=C(()=>{const d=$(e);return Array.isArray(d)?d.map(y=>P(y)):[P(d)]}),s=W(c,d=>{if(a(),i.value&&n){l=new ResizeObserver(t);for(const y of d)y&&l.observe(y,r)}},{immediate:!0,flush:"post"}),u=()=>{a(),s()};return fe(u),{isSupported:i,stop:u}}function go(e,t={width:0,height:0},o={}){const{window:n=X,box:r="content-box"}=o,l=C(()=>{var d,y;return(y=(d=P(e))==null?void 0:d.namespaceURI)==null?void 0:y.includes("svg")}),i=k(t.width),a=k(t.height),{stop:c}=De(e,([d])=>{const y=r==="border-box"?d.borderBoxSize:r==="content-box"?d.contentBoxSize:d.devicePixelContentBoxSize;if(n&&l.value){const m=P(e);if(m){const p=m.getBoundingClientRect();i.value=p.width,a.value=p.height}}else if(y){const m=Array.isArray(y)?y:[y];i.value=m.reduce((p,{inlineSize:b})=>p+b,0),a.value=m.reduce((p,{blockSize:b})=>p+b,0)}else i.value=d.contentRect.width,a.value=d.contentRect.height},o);tt(()=>{const d=P(e);d&&(i.value="offsetWidth"in d?d.offsetWidth:t.width,a.value="offsetHeight"in d?d.offsetHeight:t.height)});const s=W(()=>P(e),d=>{i.value=d?t.width:0,a.value=d?t.height:0});function u(){c(),s()}return{width:i,height:a,stop:u}}K.mounted+"";function ke(e,t,o={}){const{root:n,rootMargin:r="0px",threshold:l=0,window:i=X,immediate:a=!0}=o,c=ot(()=>i&&"IntersectionObserver"in i),s=C(()=>{const p=$(e);return(Array.isArray(p)?p:[p]).map(P).filter(oo)});let u=O;const d=k(a),y=c.value?W(()=>[s.value,P(n),d.value],([p,b])=>{if(u(),!d.value||!p.length)return;const D=new IntersectionObserver(t,{root:P(b),rootMargin:r,threshold:l});p.forEach(g=>g&&D.observe(g)),u=()=>{D.disconnect(),u=O}},{immediate:a,flush:"post"}):O,m=()=>{u(),y(),d.value=!1};return fe(m),{isSupported:c,isActive:d,pause(){u(),d.value=!1},resume(){d.value=!0},stop:m}}function Ce(e,t={}){const{window:o=X,scrollTarget:n,threshold:r=0}=t,l=k(!1);return ke(e,i=>{let a=l.value,c=0;for(const s of i)s.time>=c&&(c=s.time,a=s.isIntersecting);l.value=a},{root:n,window:o,threshold:r}),l}K.mounted+"";function re(e){return typeof Window!="undefined"&&e instanceof Window?e.document.documentElement:typeof Document!="undefined"&&e instanceof Document?e.documentElement:e}const Fe=1;function qe(e,t={}){const{throttle:o=0,idle:n=200,onStop:r=O,onScroll:l=O,offset:i={left:0,right:0,top:0,bottom:0},eventListenerOptions:a={capture:!1,passive:!0},behavior:c="auto",window:s=X,onError:u=_=>{console.error(_)}}=t,d=k(0),y=k(0),m=C({get(){return d.value},set(_){b(_,void 0)}}),p=C({get(){return y.value},set(_){b(void 0,_)}});function b(_,v){var A,R,Y,N;if(!s)return;const Q=$(e);if(!Q)return;(Y=Q instanceof Document?s.document.body:Q)==null||Y.scrollTo({top:(A=$(v))!=null?A:p.value,left:(R=$(_))!=null?R:m.value,behavior:$(c)});const ae=((N=Q==null?void 0:Q.document)==null?void 0:N.documentElement)||(Q==null?void 0:Q.documentElement)||Q;m!=null&&(d.value=ae.scrollLeft),p!=null&&(y.value=ae.scrollTop)}const D=k(!1),g=we({left:!0,right:!1,top:!0,bottom:!1}),L=we({left:!1,right:!1,top:!1,bottom:!1}),h=_=>{!D.value||(D.value=!1,L.left=!1,L.right=!1,L.top=!1,L.bottom=!1,r(_))},f=uo(h,o+n),q=_=>{var v;if(!s)return;const A=((v=_==null?void 0:_.document)==null?void 0:v.documentElement)||(_==null?void 0:_.documentElement)||P(_),{display:R,flexDirection:Y}=getComputedStyle(A),N=A.scrollLeft;L.left=N<d.value,L.right=N>d.value;const Q=Math.abs(N)<=(i.left||0),ae=Math.abs(N)+A.clientWidth>=A.scrollWidth-(i.right||0)-Fe;R==="flex"&&Y==="row-reverse"?(g.left=ae,g.right=Q):(g.left=Q,g.right=ae),d.value=N;let Z=A.scrollTop;_===s.document&&!Z&&(Z=s.document.body.scrollTop),L.top=Z<y.value,L.bottom=Z>y.value;const Ee=Math.abs(Z)<=(i.top||0),$e=Math.abs(Z)+A.clientHeight>=A.scrollHeight-(i.bottom||0)-Fe;R==="flex"&&Y==="column-reverse"?(g.top=$e,g.bottom=Ee):(g.top=Ee,g.bottom=$e),y.value=Z},I=_=>{var v;if(!s)return;const A=(v=_.target.documentElement)!=null?v:_.target;q(A),D.value=!0,f(_),l(_)};return F(e,"scroll",o?co(I,o,!0,!1):I,a),tt(()=>{try{const _=$(e);if(!_)return;q(_)}catch(_){u(_)}}),F(e,"scrollend",h,a),{x:m,y:p,isScrolling:D,arrivedState:g,directions:L,measure(){const _=$(e);s&&_&&q(_)}}}function We(e,t,o={}){var n;const{direction:r="bottom",interval:l=100,canLoadMore:i=()=>!0}=o,a=we(qe(e,{...o,offset:{[r]:(n=o.distance)!=null?n:0,...o.offset}})),c=k(),s=C(()=>!!c.value),u=C(()=>re($(e))),d=Ce(u);function y(){if(a.measure(),!u.value||!d.value||!i(u.value))return;const{scrollHeight:p,clientHeight:b,scrollWidth:D,clientWidth:g}=u.value,L=r==="bottom"||r==="top"?p<=b:D<=g;(a.arrivedState[r]||L)&&(c.value||(c.value=Promise.all([t(a),new Promise(h=>setTimeout(h,l))]).finally(()=>{c.value=null,be(()=>y())})))}const m=W(()=>[a.arrivedState[r],d.value],y,{immediate:!0});return mo(m),{isLoading:s,reset(){be(()=>y())}}}K.mounted+"";K.mounted+"";K.mounted+"";K.mounted+"";function nt(e){const t=window.getComputedStyle(e);if(t.overflowX==="scroll"||t.overflowY==="scroll"||t.overflowX==="auto"&&e.clientWidth<e.scrollWidth||t.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const o=e.parentNode;return!o||o.tagName==="BODY"?!1:nt(o)}}function _o(e){const t=e||window.event,o=t.target;return nt(o)?!1:t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}const ge=new WeakMap;function bo(e,t=!1){const o=k(t);let n=null,r="";W(so(e),a=>{const c=re($(a));if(c){const s=c;if(ge.get(s)||ge.set(s,s.style.overflow),s.style.overflow!=="hidden"&&(r=s.style.overflow),s.style.overflow==="hidden")return o.value=!0;if(o.value)return s.style.overflow="hidden"}},{immediate:!0});const l=()=>{const a=re($(e));!a||o.value||(Te&&(n=F(a,"touchmove",c=>{_o(c)},{passive:!1})),a.style.overflow="hidden",o.value=!0)},i=()=>{const a=re($(e));!a||!o.value||(Te&&(n==null||n()),a.style.overflow=r,ge.delete(a),o.value=!1)};return fe(i),C({get(){return o.value},set(a){a?l():i()}})}function wo(){let e=!1;const t=k(!1);return(o,n)=>{if(t.value=n.value,e)return;e=!0;const r=bo(o,n.value);W(t,l=>r.value=l)}}wo();const So={key:1},xo={key:2,class:"q-mb-sm"},To={key:3},Ne="Title of the Day",Do=te({__name:"DayHeaderBlock",props:{simply:{type:Boolean,required:!1,dafault:!1}},setup(e){const t=ne(),o=e,n=k(!1),r=k(null),l=()=>{n.value=!1,!(t.day!=null&&r.value===t.day.title)&&t.updateDayTitle(r.value)},i=()=>{r.value=t.day!=null?t.day.title:null,n.value=!0};return(a,c)=>{const s=z("page-block");return x(t).day?(T(),E(s,{key:0,class:"text-center"},{default:w(()=>[n.value?(T(),B("div",So,[de(S(it,{modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=u=>r.value=u),autofocus:"",dense:"",style:{"text-align":"center"},class:"text-h5",placeholder:Ne,onKeydown:Mt(Vt(l,["exact","prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),[[x(fo),l]])])):(T(),B("div",{key:0,class:"text-h5 cursor-pointer",onClick:i},[j("div",{class:ee({"half-dimmed":!x(t).day.title})},oe(x(t).day.title?x(t).day.title:Ne),3)])),o.simply?U("",!0):(T(),B("div",xo,[S(Jt,{size:"xs",modelValue:x(t).day.rate,"onUpdate:modelValue":[c[1]||(c[1]=u=>x(t).day.rate=u),c[2]||(c[2]=u=>x(t).updateDayRate(u))],color:"primary"},null,8,["modelValue"])])),o.simply?U("",!0):(T(),B("div",To,[S(to)]))]),_:1})):U("",!0)}}}),ko=te({__name:"DaysAgoBadge",setup(e){const t=ne(),o=C(()=>{const n=M.compareDates(M.getTodayDate(),M.timestampToDate(t.day.startDateTime));return n==0?{label:"today",color:"positive"}:n==1?{label:"yesterday",color:"orange"}:{label:`${n} d. ago`,color:"blue"}});return(n,r)=>x(t).day?(T(),E(Se,{key:0,outline:"",color:o.value.color},{default:w(()=>[o.value.label!=="today"&&o.value.label!=="yesterday"?(T(),E(ue,{key:0,name:"eva-undo-outline",size:"14px",class:"q-ml-xs"})):U("",!0),J(" "+oe(o.value.label),1)]),_:1},8,["color"])):U("",!0)}}),Co={key:0,class:"text-center block-caption"},qo={class:"q-ma-lg"},Ao=te({__name:"DiaryDayCard",setup(e){const t=ne(),o=k(!0),n=C(()=>M.timestampToReadableDate(t.day.startDateTime)),r=()=>{if(!t.day.endDateTime)return;const s=M.addDay(M.timestampToDate(t.day.startDateTime));i(s)},l=()=>{const s=M.substractDay(M.timestampToDate(t.day.startDateTime));i(s)},i=s=>{const u=t.day.startDateTime;M.getMonth(u)==M.getMonth(s)?c(s):a({day:null,month:M.getMonth(s),year:M.getYear(s)}).then(()=>{c(s)}).catch(()=>{log.error("Unable to load days for previous month")})},a=s=>t.searchDays(s),c=s=>{const u=t.days.filter(d=>M.timestampToDate(d.startDateTime)==s)[0];t.retrieveMyDayById(u.id)};return(s,u)=>{const d=z("scroll-area"),y=z("app-card");return T(),E(y,null,{default:w(()=>[de((T(),E(Rt,null,{default:w(()=>[S(d,{class:ee(`all-height-${x(H)()?"desktop-padding":"mobile-padding"}`)},{default:w(()=>[x(t).day?(T(),B("div",Co,[J(oe(n.value)+" ",1),o.value?(T(),E(ko,{key:0})):U("",!0)])):U("",!0),S(Do,{simply:!o.value},null,8,["simply"]),j("div",qo,[x(t).day?(T(),E(Xe,{key:0},{default:w(()=>[(T(!0),B(se,null,Le(x(t).day.entries,m=>(T(),E(Xt,{key:m.id,entry:m,simply:!o.value},null,8,["entry","simply"]))),128))]),_:1})):U("",!0)])]),_:1},8,["class"])]),_:1})),[[Ve,l,void 0,{mouse:!0,right:!0}],[Ve,r,void 0,{mouse:!0,left:!0}]])]),_:1})}}});const Lo="blur(4px) saturate(150%)",je=750,un=te({__name:"DiaryPage",setup(e){const t=k(!1),o=k(!1);Nt();const n=ne();return me(()=>{n.retrieveTags(),n.retrieveLastDay()}),(r,l)=>{const i=z("app-page");return T(),E(i,null,{default:w(()=>[S(ct,{view:"lHr Lpr lFr",container:"",class:ee(`all-height-${x(H)()?"desktop":"mobile"}`)},{default:w(()=>[x(H)()?(T(),E(Ie,{key:0,modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value=a),"show-if-above":"",width:360,breakpoint:je,elevated:!x(H)(),class:ee({"q-pr-lg":x(H)(),"bg-page":x(H)(),"bg-card":!x(H)()})},{default:w(()=>[S(dt,{class:"full-height",onClose:l[0]||(l[0]=a=>t.value=!1)})]),_:1},8,["modelValue","elevated","class"])):U("",!0),x(H)()?(T(),E(Ie,{key:1,modelValue:o.value,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value=a),side:"right",width:x(H)()?(t.value,200):300,breakpoint:je,elevated:!x(H)(),class:ee({"q-pl-lg":x(H)(),"bg-page":x(H)(),"bg-card":!x(H)()})},{default:w(()=>[S(He,{class:"all-height-desktop"})]),_:1},8,["modelValue","width","elevated","class"])):(T(),E(rt,{key:2,maximized:"",modelValue:o.value,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value=a),"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":Lo},{default:w(()=>[S(He,{class:"full-height"})]),_:1},8,["modelValue"])),S(ut,null,{default:w(()=>[S(st,{class:ee(`
              all-height-${x(H)()?"desktop":"mobile"}
            `)},{default:w(()=>[S(Ao,{class:ee(`all-height-${x(H)()?"desktop":"mobile"}`)},null,8,["class"])]),_:1},8,["class"])]),_:1})]),_:1},8,["class"])]),_:1})}}});export{un as default};
