import{k as p,r as w,G as z,as as E,at as H,o as A,h as P,l as O,g as Q,am as I,af as $,B as D,au as L,av as _,i as j,m as B,O as M,c as y,w as b,n as k,R as K,q as U}from"./index.07e5bfa0.js";import{Q as G}from"./use-quasar.6667bf8a.js";var J=p({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(o,{slots:m,emit:d}){const v=Q(),t=w(null);let l=0;const r=[];function x(n){const c=typeof n=="boolean"?n:o.noErrorFocus!==!0,u=++l,f=(a,i)=>{d(`validation${a===!0?"Success":"Error"}`,i)},q=a=>{const i=a.validate();return typeof i.then=="function"?i.then(e=>({valid:e,comp:a}),e=>({valid:!1,comp:a,err:e})):Promise.resolve({valid:i,comp:a})};return(o.greedy===!0?Promise.all(r.map(q)).then(a=>a.filter(i=>i.valid!==!0)):r.reduce((a,i)=>a.then(()=>q(i).then(e=>{if(e.valid===!1)return Promise.reject(e)})),Promise.resolve()).catch(a=>[a])).then(a=>{if(a===void 0||a.length===0)return u===l&&f(!0),!0;if(u===l){const{comp:i,err:e}=a[0];if(e!==void 0&&console.error(e),f(!1,i),c===!0){const s=a.find(({comp:V})=>typeof V.focus=="function"&&I(V.$)===!1);s!==void 0&&s.comp.focus()}}return!1})}function h(){l++,r.forEach(n=>{typeof n.resetValidation=="function"&&n.resetValidation()})}function F(n){n!==void 0&&$(n);const c=l+1;x().then(u=>{c===l&&u===!0&&(o.onSubmit!==void 0?d("submit",n):n!==void 0&&n.target!==void 0&&typeof n.target.submit=="function"&&n.target.submit())})}function S(n){n!==void 0&&$(n),d("reset"),D(()=>{h(),o.autofocus===!0&&o.noResetFocus!==!0&&g()})}function g(){L(()=>{if(t.value===null)return;const n=t.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(t.value.querySelectorAll("[tabindex]"),c=>c.tabIndex!==-1);n!=null&&n.focus({preventScroll:!0})})}z(_,{bindComponent(n){r.push(n)},unbindComponent(n){const c=r.indexOf(n);c!==-1&&r.splice(c,1)}});let C=!1;return E(()=>{C=!0}),H(()=>{C===!0&&o.autofocus===!0&&g()}),A(()=>{o.autofocus===!0&&g()}),Object.assign(v.proxy,{validate:x,resetValidation:h,submit:F,reset:S,focus:g,getValidationComponents:()=>r}),()=>P("form",{class:"q-form",ref:t,onSubmit:F,onReset:S},O(m.default))}}),W=p({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(o,{slots:m,emit:d}){const{proxy:{$q:v}}=Q(),t=j(U,B);if(t===B)return console.error("QFooter needs to be child of QLayout"),B;const l=w(parseInt(o.heightHint,10)),r=w(!0),x=w(M.value===!0||t.isContainer.value===!0?0:window.innerHeight),h=y(()=>o.reveal===!0||t.view.value.indexOf("F")!==-1||v.platform.is.ios&&t.isContainer.value===!0),F=y(()=>t.isContainer.value===!0?t.containerHeight.value:x.value),S=y(()=>{if(o.modelValue!==!0)return 0;if(h.value===!0)return r.value===!0?l.value:0;const e=t.scroll.value.position+F.value+l.value-t.height.value;return e>0?e:0}),g=y(()=>o.modelValue!==!0||h.value===!0&&r.value!==!0),C=y(()=>o.modelValue===!0&&g.value===!0&&o.reveal===!0),n=y(()=>"q-footer q-layout__section--marginal "+(h.value===!0?"fixed":"absolute")+"-bottom"+(o.bordered===!0?" q-footer--bordered":"")+(g.value===!0?" q-footer--hidden":"")+(o.modelValue!==!0?" q-layout--prevent-focus"+(h.value!==!0?" hidden":""):"")),c=y(()=>{const e=t.rows.value.bottom,s={};return e[0]==="l"&&t.left.space===!0&&(s[v.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),e[2]==="r"&&t.right.space===!0&&(s[v.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),s});function u(e,s){t.update("footer",e,s)}function f(e,s){e.value!==s&&(e.value=s)}function q({height:e}){f(l,e),u("size",e)}function R(){if(o.reveal!==!0)return;const{direction:e,position:s,inflectionPoint:V}=t.scroll.value;f(r,e==="up"||s-V<100||t.height.value-F.value-s-l.value<300)}function a(e){C.value===!0&&f(r,!0),d("focusin",e)}b(()=>o.modelValue,e=>{u("space",e),f(r,!0),t.animate()}),b(S,e=>{u("offset",e)}),b(()=>o.reveal,e=>{e===!1&&f(r,o.modelValue)}),b(r,e=>{t.animate(),d("reveal",e)}),b([l,t.scroll,t.height],R),b(()=>v.screen.height,e=>{t.isContainer.value!==!0&&f(x,e)});const i={};return t.instances.footer=i,o.modelValue===!0&&u("size",l.value),u("space",o.modelValue),u("offset",S.value),k(()=>{t.instances.footer===i&&(t.instances.footer=void 0,u("size",0),u("offset",0),u("space",!1))}),()=>{const e=K(m.default,[P(G,{debounce:0,onResize:q})]);return o.elevated===!0&&e.push(P("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),P("footer",{class:n.value,style:c.value,onFocusin:a},e)}}});function X(o){let m="";o>0&&(m="+"),o<0&&(m="-");const d="$",v=Math.abs(o),t=v.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return`${m} ${d} ${t}`}function Y(o){return o>0?"text-positive":o<0?"text-negative":"text-grey-6"}export{J as Q,W as a,X as b,Y as u};
